<!DOCTYPE html>
<html>
<head>
    <title>Moksha OTP</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
</head>
<body>
    <div id="recaptcha-container"></div>
    <script>
        // Replace these values with your ACTUAL Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyB_oD-E7MGqLZAXOadtA_Xk928lT1utEB0", 
            authDomain: " otpverification-fdc07.firebaseapp.com",
            projectId: "otpverification-fdc07",
            storageBucket: " otpverification-fdc07.appspot.com",
            messagingSenderId: " 714761796238",	
            appId: "1:714761796238:android:fffe3caa21cab261efe7df"
        };
        firebase.initializeApp(firebaseConfig);

        function sendOTP(number) {
            const phoneNumber = "+" + number;
            const appVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', { 'size': 'invisible' });
            
            firebase.auth().signInWithPhoneNumber(phoneNumber, appVerifier)
                .then((confirmationResult) => {
                    window.confirmationResult = confirmationResult;
                    // HANDSHAKE: Tells App Inventor the SMS was sent
                    window.AppInventor.setWebViewString("SENT");
                }).catch((error) => {
                    alert("Error: " + error.message);
                });
        }

        function verifyOTP(code) {
            confirmationResult.confirm(code).then((result) => {
                // HANDSHAKE: Tells App Inventor verification is successful
                window.AppInventor.setWebViewString("VERIFIED");
            }).catch((error) => {
                alert("Invalid Code");
            });
        }
    </script>
</body>
</html>
